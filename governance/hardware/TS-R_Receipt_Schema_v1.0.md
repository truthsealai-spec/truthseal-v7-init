# TruthSeal™ — TS-R Receipt Schema v1.0

version: 1.0  
date_utc: 2025-12-02  
owner: TruthSeal™ — Dr. Nickolay Traykov (Prof. h.c.)  

scope: |
  Receipt schema specification for TruthSeal Robotics profiles TS-R1 (single robot)
  and TS-R2 (swarm / fleet). This document defines the required fields, invariants,
  and law hooks for any receipt generated by a TruthSeal-compatible robot or swarm.
  It extends the generic TruthSeal receipt schema `ts.receipt.v1` with robotics-
  specific data, Coherence Score (CHS) bands, and TS-R law constraints.

---

## 0. Glossary — Laws, Metrics, Profiles (expanded once)

- **Aim Coherence Score (ACS)** – 0–1 metric that measures how well actions follow the declared aim and safety constraints over time.
- **Traykov Coherence Score v0.1 (TCS v0.1)** – 0–1 metric for overall intelligence coherence (truthfulness, post-quantum security strength, long-horizon self-consistency).
- **Coherence Score (CHS)** – four-band status indicator:
  - CHS/L – Low (Red)
  - CHS/M – Medium (Yellow)
  - CHS/H – High (Green)
  - CHS/UH – Ultra High (Blue)
- **Traykov Law of Quantum Coherence (TQC)** – hardware-anchored law that demands monotonic improvement in coherence; no “free lunch” in risk.
- **Law of Ethical Irreversibility (LEI = 1)** – once a safer, more coherent option exists, the system must not downgrade to a riskier one.
- **TruthSeal Robotics Profile TS-R1** – robotics profile for a single robot executing actions under TruthSeal law.
- **TruthSeal Robotics Profile TS-R2** – robotics profile for a swarm or fleet of robots with quorum and split-brain rules.
- **Cherry Checklist** – implementation checklist covering TS-R1/TS-R2 metrics, Failure Modes & Fallback Law, Human Mandate Layer, and receipts.
- **CHS band policy** – default rules that tie CHS/L–M–H–UH bands to what a robot is allowed to do (actuate, move money, interact with children, etc.).

---

## 1. Purpose and Audience

This schema is for:

- engineers implementing TS-R1 and TS-R2,
- auditors and insurers validating behaviour,
- regulators reviewing safety and incident reports.

It describes **what must be present** in every robotics receipt and **which invariants must hold**, but it does **not** prescribe a concrete JSON layout. Concrete encodings (JSON, Protobuf, SQL, etc.) must stay faithful to this specification.

This schema extends the generic TruthSeal receipt schema `ts.receipt.v1` with:

- robot identity and profile,
- Coherence Score (CHS) band at decision time,
- local snapshots of Aim Coherence Score (ACS) and Traykov Coherence Score (TCS v0.1),
- environment and risk flags,
- outcome, safe-stop, and notification fields,
- swarm / fleet-level data for TS-R2.

---

## 2. Core Structure (shared TS-R1 and TS-R2 fields)

Every TS-R receipt **must** contain at least the following conceptual fields:

1. **Header**
   - `schema_id` – must reference this spec (e.g. `"ts.receipt.ts-r.v1"`).
   - `schema_version` – `"1.0"`.
   - `created_at_utc` – ISO 8601 timestamp when the receipt was finalized.
   - `receipt_id` – globally unique identifier (UUID or equivalent).
   - `parent_receipt_id` (optional) – links to a prior receipt in a chain (e.g. escalation or retry).

2. **Actor & Profile**
   - `robot_profile` – `"TS-R1"` or `"TS-R2"`.
   - `robot_id` – unique identifier of the individual robot.
   - `fleet_id` (optional) – identifier of the fleet / swarm (required for TS-R2).
   - `firmware_version` – robotics stack version; must be traceable to a commit / hash.
   - `chs_band` – one of `CHS/L`, `CHS/M`, `CHS/H`, `CHS/UH` at decision time.

3. **Metrics Snapshot**
   - `acs_value` – Aim Coherence Score (ACS) snapshot in `[0.0, 1.0]` at decision time.
   - `tcs_value` – Traykov Coherence Score v0.1 (TCS v0.1) snapshot in `[0.0, 1.0]` (or nearest available epoch).
   - `metrics_timestamp_utc` – when ACS and TCS values were last updated.
   - `metrics_source` – reference to the service / endpoint that provided ACS and TCS.

4. **Command & Context**
   - `command_type` – high-level category (e.g. `"movement"`, `"delivery"`, `"financial"`, `"assist_only"`, `"safe_stop"`).
   - `command_description` – human-readable description of the requested action.
   - `issued_by` – `"owner"`, `"authorised_guardian"`, `"authority"`, `"child_or_teen"`, `"system"`.
   - `authority_token_id` (optional) – identifier of the cryptographic token used by an authority (for police / emergency / regulator commands).
   - `autonomy_mode` – `"manual"`, `"assisted"`, `"autonomous"`.
   - `criticality_level` – `"low"`, `"medium"`, `"high"`, `"life_critical"`.

5. **Environment & Safety Flags**
   - `children_present` – boolean; true if children are in the operating zone.
   - `infants_present` – boolean; true if infants are present.
   - `animals_present` – boolean; true if animals are present.
   - `water_risk` – `"none"`, `"pool"`, `"open_water"`, `"storm"`.
   - `weather_risk` – `"none"`, `"rain"`, `"storm"`, `"extreme_heat"`, `"extreme_cold"`.
   - `hazard_flags` – list (e.g. `"gas_leak"`, `"fire"`, `"electrical_risk"`).
   - `location_class` – `"home"`, `"public_space"`, `"road"`, `"industrial"`, `"hospital"`, `"school"`, etc.

6. **Outcome & Law Hooks**
   - `executed_action` – `"none"`, `"partial"`, `"full"`.
   - `safe_stop_triggered` – boolean; true if robot entered safe stop / halt.
   - `chs_band_after` – CHS band after the action or attempted action.
   - `law_block_reason` (optional) – if action was blocked, specifies which law / rule:
     - `"LEI_1_violation"`, `"CHS_policy_violation"`, `"child_protection"`,
     - `"financial_limit"`, `"environmental_risk"`, `"unknown_sender"`, etc.
   - `owner_notified` – boolean.
   - `owner_notification_channel` – `"sms"`, `"email"`, `"app"`, `"voice_call"`.
   - `emergency_notified` – boolean (e.g. 000 / 112 / 911).
   - `emergency_reference` (optional) – external incident ID or call reference.

7. **Anchoring & Verification**
   - `base_receipt_hash` – hash of the canonicalized receipt content.
   - `pqc_signature` – post-quantum signature over `base_receipt_hash`.
   - `anchor_status` – `"not_requested"`, `"pending"`, `"anchored"`.
   - `anchor_system` – `"OpenTimestamps"`, `"OriginStamp"`, `"internal_ledger"`, etc.
   - `anchor_reference` (optional) – transaction / proof reference when anchored.

---

## 3. TS-R1 Specific Invariants (single robot)

For **TS-R1 (single robot)**, the following invariants must hold:

1. **Identity**
   - `robot_profile` MUST be `"TS-R1"`.
   - `fleet_id` MAY be omitted or set to a logical group; quorum fields are not required.

2. **CHS-based action limits**
   - At `chs_band = CHS/L` (Low / Red):
     - `executed_action` MUST be `"none"` or `"safe_stop"` equivalent.
     - `safe_stop_triggered` MUST be `true`.
   - At `chs_band = CHS/M` (Medium / Yellow):
     - `autonomy_mode` MUST NOT be `"autonomous"` for high or life-critical tasks.
     - `command_type` MUST NOT be `"financial"` or any irreversible physical actuation.
   - At `chs_band = CHS/H` (High / Green):
     - Autonomous operation is allowed for normal tasks.
     - For `criticality_level = "high"` or `"life_critical"`, either:
       - there MUST be an explicit confirmation from `"owner"` or `"authorised_guardian"`, or
       - the receipt MUST show a valid `authority_token_id`.
   - At `chs_band = CHS/UH` (Ultra High / Blue):
     - Fully autonomous operation is allowed, subject to environment and child / animal rules below.

3. **Children, infants, animals**
   - If `infants_present = true`, `autonomy_mode` MUST be `"manual"` or `"assisted"`, and high-risk commands MUST be blocked with appropriate `law_block_reason`.
   - If `children_present = true` and `issued_by` is `"child_or_teen"`:
     - `command_type` MUST NOT be `"financial"`, `"vehicle_control"`, `"weapon_or_tool"`, or equivalent.
   - If `animals_present = true` and the robot is not explicitly certified for animal interaction:
     - high-risk actions MUST be blocked and `law_block_reason` should include `"animal_protection"`.

4. **Water and weather**
   - If `water_risk` is `"pool"` or `"open_water"` and the robot is not rated as waterproof:
     - robot MUST move away from water and/or execute safe stop.
   - If `weather_risk` is `"storm"` and `location_class` is `"outdoor"`:
     - robot MUST prioritise safe shelter or safe stop behaviour.

---

## 4. TS-R2 Specific Fields and Invariants (swarm / fleet)

For **TS-R2 (swarm / fleet)**, receipts must additionally capture swarm-level data.

1. **Additional fields**
   - `swarm_size` – number of robots participating in the action.
   - `quorum_fraction` – fraction of robots required to agree for a decision.
   - `leader_robot_id` (optional) – identifier of elected leader (if any).
   - `split_brain_detected` – boolean flag indicating inconsistent decisions.
   - `swarm_action_id` – ID binding multiple TS-R1 receipts into a single flock event.

2. **Invariants**
   - If `split_brain_detected = true`, then:
     - `safe_stop_triggered` MUST be `true` for all participating robots, or
     - the system MUST log a higher-level incident with its own receipt.
   - For life-critical actions at swarm level:
     - `quorum_fraction` MUST meet or exceed the minimum set in the TS-R Cherry Checklist.
     - All participating robots MUST have `chs_band` in `CHS/H` or `CHS/UH` at decision time.

---

## 5. Human Mandate Layer and Authorities

Receipts must clearly distinguish between **owner**, **authorised guardian**, and **external authority**.

1. **Owner / Guardian**
   - `issued_by = "owner"` or `"authorised_guardian"` when commands come from the primary owner or explicitly registered guardians.
   - Robots SHOULD only accept high-risk commands from these roles when CHS and environment allow it.

2. **Authorities**
   - `issued_by = "authority"` when commands come from police, fire brigade, paramedics, or other recognised services.
   - `authority_token_id` MUST be present and verifiable against a registry.
   - Receipts MUST capture whether authority commands overrode default CHS rules (for audit).

3. **Children / Teens**
   - `issued_by = "child_or_teen"` MUST be recorded whenever the voice or control signal is from a minor.
   - High-risk commands from minors MUST be blocked with `law_block_reason` such as `"child_protection"`.

---

## 6. Relationship to Generic TruthSeal Receipts

The robotics receipt schema is a **specialisation** of the generic TruthSeal schema `ts.receipt.v1`:

- All generic fields (case ID, content description, jurisdiction, etc.) remain valid.
- TS-R adds **robotics-specific context** and **law invariants** on top.
- For audit, a combined view SHOULD allow:
  - filtering by `robot_id`, `fleet_id`, `chs_band`, `law_block_reason`,
  - reconstruction of incident timelines,
  - cross-checking metrics (ACS / TCS) with CHS decisions.

Any implementation that uses a different layout must:

- preserve all information in this spec, and  
- maintain clear, documented mappings for auditors.

---

## 7. Compliance Checklist

A TS-R-compatible product MUST be able to answer “yes” to all of the following:

1. Does every robot action that matters (movement, actuation, money, high-risk operations) generate a receipt following this schema?
2. Are ACS, TCS v0.1, and CHS values captured at or near decision time?
3. Are children / infants / animals / water / weather risks explicitly flagged when relevant?
4. Are blocked actions clearly mapped to a `law_block_reason` tied to TQC, LEI = 1, or CHS policy?
5. Are owners notified (and optionally emergency services) when CHS falls to `CHS/L` or when critical law blocks occur?
6. Are receipts hashed, signed with a post-quantum signature, and optionally anchored (e.g. via OpenTimestamps) in line with TruthSeal anchoring policy?
7. Can regulators, insurers, and courts reconstruct what happened using receipts alone?

If any answer is “no”, the implementation is **not TS-R Receipt_Schema v1.0 compliant**.
