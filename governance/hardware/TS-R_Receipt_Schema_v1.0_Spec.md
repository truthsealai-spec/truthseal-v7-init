# TruthSeal™ — TS-R Receipt Schema v1.0

version: 1.0  
date_utc: 2025-12-02  
owner: TruthSeal™ — Dr. Nickolay Traykov (Prof. h.c.)

scope: |  
  Receipt schema specification for TruthSeal Robotics profiles TS-R1 (single robot)  
  and TS-R2 (swarm / fleet). This document defines the required fields, invariants,  
  and law hooks for any receipt generated by a TruthSeal-compatible robot or swarm.  
  It extends the generic TruthSeal receipt schema `ts.receipt.v1` with robotics-  
  specific data, Coherence Score (CHS) bands, and TS-R law constraints. For TS-R2  
  swarms, this schema must be read together with **TS-R Swarm Extensions v1.0**.

---

## 0. Glossary — Laws, Metrics, Profiles (expanded once)

- **Aim Coherence Score (ACS)** — 0–1 metric that measures how well actions
  follow the declared aim and safety constraints over time.

- **Traykov Coherence Score v0.1 (TCS v0.1)** — 0–1 metric for overall
  intelligence coherence (truthfulness, post-quantum security strength,
  long-horizon self-consistency).

- **Coherence Score (CHS)** — four-band status indicator for a robot or swarm:
  - **CHS/L — Low (Red)**: coherence and safety too weak for autonomous actuation.  
    Assist-only; TS-R Failure Modes & Fallback Law must trigger safe halt.
  - **CHS/M — Medium (Yellow)**: can assist and suggest; irreversible actuation
    requires explicit human command under Human Mandate Layer.
  - **CHS/H — High (Green)**: can execute normal tasks; high-risk actions must
    still pass Human Mandate + safety checks.
  - **CHS/UH — Ultra High (Blue)**: only band allowed for fully autonomous
    high-stakes actions, and only within approved profiles.

- **Traykov Law of Quantum Coherence (TQC)** — hardware-anchored law that
  prohibits degrading coherence behaviour over time; receipts must show that
  ACS/TCS/CHS stay within approved envelopes for the declared use.

- **Law of Ethical Irreversibility (LEI = 1)** — once a safer, more coherent
  configuration is available, the system may not revert to a worse one without
  explicit, logged human mandate.

- **TS-R1** — TruthSeal Robotics profile for a single robot, bound to:
  hardware ID, software stack, location / jurisdiction, ACS/TCS/CHS envelope,
  and TS-R laws (Failure Modes, Human Mandate, Receipt Schema).

- **TS-R2** — TruthSeal Robotics profile for a swarm / fleet operating under a
  shared law, metric, and mandate profile. TS-R2 receipts add swarm-level
  identifiers and coordination fields defined in **TS-R Swarm Extensions v1.0**.

- **ULLI** — Underlying Law of Logical & Inquiry Coherence; the doctrinal
  backbone that couples ACS, TCS, CHS and LEI=1 across hardware, software and law.

---

## 1. Purpose

This schema defines **what every TS-R robotics receipt must contain** so that
auditors, regulators, insurers, and partners can:

1. Verify that a robot or swarm acted within its **declared aim and safety
   constraints**.
2. Check that the action respected **CHS band limits** and TS-R laws
   (TQC, LEI=1, Failure Modes & Fallback, Human Mandate).
3. Anchor the event to the TruthSeal ledger and external timestamping
   services (e.g., OpenTimestamps) for **immutable proof**.

It is **normative**: if a field here is marked *required*, a TS-R receipt that
omits or corrupts it is non-compliant.

---

## 2. Schema Overview

A TS-R robotics receipt extends the generic TruthSeal `ts.receipt.v1` envelope:

- `envelope` — generic receipt header (id, issuer, subject, timestamps,
  jurisdiction, anchoring).
- `tsr_robotics` — robotics-specific block (TS-R1 / TS-R2).
- `tsr_metrics` — coherence and safety metrics (ACS, TCS, CHS, trends).
- `tsr_event` — description of aim, context, and action(s).
- `tsr_fallback` — failure modes, overrides, degradations, and outcomes.
- `tsr_mandate` — Human Mandate Layer context (who authorised what, at which
  mandate level).
- `tsr_anchoring` — TruthSeal ledger and timestamping hooks.

For **TS-R2** swarms an additional block is present:

- `tsr_swarm` — swarm-level identifiers and coordination state, as specified
  in **TS-R Swarm Extensions v1.0**.

---

## 3. Core Envelope Fields (shared with ts.receipt.v1)

**Required envelope fields:**

- `receipt_id` (string, UUID) — globally unique identifier.
- `schema` (string) — must be `"tsr.receipt.v1"`.
- `version` (string) — semantic version of this schema, e.g. `"1.0.0"`.
- `issuer` (object)
  - `name` (string) — organisation operating the robot(s).
  - `id` (string) — TruthSeal issuer id or legal registration number.
- `issued_at_utc` (ISO-8601) — time the receipt was sealed.
- `jurisdiction` (string) — legal jurisdiction primarily responsible.
- `environment` (enum) — `test | simulation | sandbox | pilot | production`.

**Anchoring envelope fields (generic):**

- `evidence_hash` (string, hex) — SHA-256 digest over the canonical receipt
  body (including tsr blocks).
- `ledger_path` (string) — canonical path inside the TruthSeal ledger.
- `ots_calendar_id` (string, hex) — OpenTimestamps calendar identifier
  (when available).
- `ots_receipt_ref` (string) — reference or path to the .ots receipt file.
- `anchor_status` (enum) — `pending | receipt_issued | anchored`.

---

## 4. TS-R Robotics Block (`tsr_robotics`)

**Required for TS-R1 and TS-R2:**

- `profile` (enum) — `TS-R1 | TS-R2`.
- `hardware_id` (string) — stable identifier for the physical robot chassis
  (serial, chip id, or cryptographic device id).
- `software_stack` (object)
  - `os` (string) — operating system / firmware baseline.
  - `control_stack` (string) — control software release id.
  - `ai_stack` (string) — AI / model bundle identifier.
- `location_mode` (enum)
  - `fixed_site` — factory, warehouse, hospital, etc.
  - `mobile_local` — indoor or local-area navigation.
  - `mobile_global` — cross-site, cross-jurisdiction mobility.

**Additional required fields for TS-R2 (swarm / fleet):**

- `swarm_id` (string) — logical identifier binding this robot to a TS-R2
  swarm as defined in **TS-R Swarm Extensions v1.0**.
- `swarm_role` (enum) — `leader | follower | sentinel | coordinator |
  autonomous_unit | other`.
- `swarm_tick` (integer) — monotonic swarm-time counter for this receipt.
- `swarm_coherence_snapshot_ref` (string) — reference to swarm-level
  coherence snapshot recorded under TS-R Swarm Extensions.

---

## 5. Coherence & Safety Metrics Block (`tsr_metrics`)

**Required fields:**

- `acs_value` (float, 0–1) — Aim Coherence Score at the time of action.
- `acs_trend` (enum) — `rising | stable | falling | unknown`.
- `tcs_value` (float, 0–1) — Traykov Coherence Score v0.1 at the time of
  action.
- `chs_band` (enum) — `CHS/L | CHS/M | CHS/H | CHS/UH`.
- `chs_score` (optional float, 0–1) — numeric score underlying the band.
- `risk_class` (enum) — `trivial | low | medium | high | critical` —
  risk class of the action as defined by TS-R Failure Modes & Fallback Law.
- `tqc_state` (enum) — `within_envelope | near_boundary | out_of_bounds`.

**Optional diagnostic fields:**

- `acs_window` (object) — window over which ACS was aggregated.
- `metric_source` (string) — implementation detail (e.g. firmware module id).
- `telemetry_hash` (string, hex) — hash of raw telemetry bundle for offline
  audit.

---

## 6. Event & Action Block (`tsr_event`)

**Required event fields:**

- `aim_statement` (string) — natural-language description of the declared aim
  (“deliver parcel to bay B7 without entering restricted zone R3”).

- `event_type` (enum) — examples:
  - `navigation`
  - `manipulation`
  - `handover`
  - `inspection`
  - `emergency_response`
  - `shutdown`
  - `other`

- `action_window` (object)
  - `started_at_utc` (ISO-8601)
  - `completed_at_utc` (ISO-8601, or `null` if aborted)

- `constraints` (array of strings) — safety / legal / physical constraints in
  effect (no-go zones, speed limits, proximity limits, payload limits, etc.).

- `outcome` (enum) — `success | partial_success | aborted_safely |
  degraded_safe_state | unsafe_condition_detected`.

**Optional, but recommended:**

- `human_present` (boolean) — whether a responsible operator was physically
  present.
- `near_miss` (boolean) — whether a near miss occurred (for statistics).
- `notes` (string) — plain-language notes by operator or auditor.

---

## 7. Failure, Fallback & Human Mandate Blocks

### 7.1 Fallback Block (`tsr_fallback`)

Fields aligned with **TS-R Failure Modes & Fallback Law v1.0**:

- `fallback_mode_entered` (boolean).
- `fallback_reason` (enum) — `sensor_fault | actuator_fault | environment_hazard |
  metric_drop | human_override | other`.
- `fallback_band_before` (enum, CHS/*).
- `fallback_band_after` (enum, CHS/*).
- `safe_state_achieved` (boolean).
- `resumed_normal_operation` (boolean).
- `resumption_approved_by` (string, optional) — id of human approver.

### 7.2 Human Mandate Block (`tsr_mandate`)

Fields aligned with **TS-R Human Mandate Layer v1.0**:

- `mandate_level` (enum) — `L0 | L1 | L2 | L3 | L4` (local naming from HML).
- `authority_role` (string) — e.g. `owner`, `site_supervisor`, `safety_officer`,
  `regulator_delegate`.
- `authority_id` (string) — TruthSeal identity, employee id, or licence number.
- `authorisation_mode` (enum) — `preapproved_policy | explicit_command |
  emergency_override`.
- `authorisation_timestamp_utc` (ISO-8601).
- `override_reason` (string, optional).
- `mandate_notes` (string, optional).

---

## 8. Anchoring & Audit Block (`tsr_anchoring`)

This block connects the robotics receipt to the wider TruthSeal ledger.

**Required fields:**

- `ulic_ref` (string) — canonical path or id of the active ULIC registry for
  this epoch.
- `evl_ref` (string) — path or id of the Epoch Verification Ledger.
- `qenc_ref` (string, optional) — reference to QENC ProofCapsule where
  applicable.
- `integrity_manifest_ref` (string) — Integrity Manifest entry that lists this
  schema/version as a verified artifact.
- `anchored` (boolean) — whether external anchoring has been confirmed.

**Optional fields:**

- `anchor_tx_id` (string) — blockchain transaction id (once anchored).
- `anchor_chain` (enum) — e.g. `bitcoin_ots | polygon_hash_only | other`.
- `audit_trail_ref` (string) — pointer to extended audit log if maintained.

---

## 9. Implementation Checklist (TS-R1 / TS-R2)

Implementation teams MUST verify the following before claiming TS-R compliance:

1. **Schema versioning**  
   - `schema = "tsr.receipt.v1"` and `version = "1.0.0"` (or a clearly
     documented compatible minor variant).

2. **Profile correctness**  
   - TS-R1 receipts use `profile = "TS-R1"` and omit swarm-only fields.  
   - TS-R2 receipts use `profile = "TS-R2"` and include `swarm_id`,
     `swarm_role`, `swarm_tick`, and `swarm_coherence_snapshot_ref` as defined
     in **TS-R Swarm Extensions v1.0**.

3. **Metric coverage**  
   - `acs_value`, `tcs_value`, and `chs_band` are present for every receipt.  
   - High-stakes actions only occur when `chs_band` is `CHS/H` or `CHS/UH`, in
     line with TS-R Failure Modes & Fallback + Human Mandate Layer.

4. **Fallback and mandate wiring**  
   - Any transition into or out of a fallback mode populates `tsr_fallback`.  
   - Any human override or explicit command is captured in `tsr_mandate`
     with `mandate_level`, `authority_role`, and `authorisation_timestamp_utc`.

5. **Anchoring discipline**  
   - `evidence_hash` covers the entire canonical receipt body (including
     `tsr_swarm` when present).  
   - `ledger_path`, `ulic_ref`, `evl_ref`, and `integrity_manifest_ref` are
     valid and resolvable in the TruthSeal ledger.  
   - Once an external timestamp is available, `ots_calendar_id`,
     `ots_receipt_ref`, `anchor_status`, and (optionally) `anchor_tx_id` are
     updated in accordance with TruthSeal anchoring policy.

A robotics vendor or operator MAY add non-conflicting fields, but MUST NOT
remove, repurpose, or silently ignore any *required* field defined here. Doing
so breaks TS-R compliance and may void legal and insurance guarantees.
