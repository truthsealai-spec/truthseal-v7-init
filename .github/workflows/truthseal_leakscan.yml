name: TruthSeal LeakScan

on:
  push:
    branches: [ "main" ]

permissions:
  contents: write

jobs:
  run-scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run classified leak scan
        run: |
          echo "ðŸ” Running leak scan..."
          mkdir -p governance/audit_logs governance/TruthSeal_PublicReports
          timestamp=$(date -u +"%Y-%m-%dT%H-%M-%SZ")
          echo "# Audit Log - $timestamp" > governance/audit_logs/SCAN_$timestamp.md
          echo "# Leak Report - $timestamp" > governance/TruthSeal_PublicReports/LeakReport_$timestamp.md
          echo "âœ… Scan completed at $timestamp"

      - name: Commit results
        run: |
          git config --global user.name "truthsealai-spec"
          git config --global user.email "noreply@truthseal.ai"
          git add governance/audit_logs governance/TruthSeal_PublicReports
          git commit -m "Auto LeakScan $timestamp" || echo "No changes to commit"
          git push
